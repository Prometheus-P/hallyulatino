---
import { type CollectionEntry, getCollection } from 'astro:content';
import ArticleLayout from '../../layouts/ArticleLayout.astro';

export async function getStaticPaths() {
  const guias = await getCollection('guias');
  return guias.map((guia) => ({
    params: { slug: guia.slug },
    props: guia,
  }));
}

type Props = CollectionEntry<'guias'>;

const guia = Astro.props;
const { Content } = await guia.render();
---

<ArticleLayout
  title={guia.data.title}
  description={guia.data.description}
  pubDate={guia.data.pubDate}
  updatedDate={guia.data.updatedDate}
  heroImage={guia.data.heroImage}
  heroImageAlt={guia.data.heroImageAlt}
  author={guia.data.author}
  tags={guia.data.tags}
  breadcrumbs={[
    { name: 'GuÃ­as', url: '/guias' },
    { name: guia.data.category, url: `/guias/categoria/${guia.data.category}` },
  ]}
>
  <!-- Guide Meta Info -->
  {(guia.data.difficulty || guia.data.readingTime) && (
    <aside class="not-prose mb-8 flex flex-wrap gap-4 text-sm">
      {guia.data.difficulty && (
        <div class="flex items-center gap-2">
          <span class="font-medium text-gray-500">Nivel:</span>
          <span class="rounded-full bg-teal-100 px-3 py-1 text-teal-800 capitalize">
            {guia.data.difficulty}
          </span>
        </div>
      )}
      {guia.data.readingTime && (
        <div class="flex items-center gap-2">
          <span class="font-medium text-gray-500">Tiempo de lectura:</span>
          <span class="text-gray-900">{guia.data.readingTime} minutos</span>
        </div>
      )}
    </aside>
  )}

  <Content />
</ArticleLayout>
