---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';

const allGuias = await getCollection('guias', ({ data }) => !data.draft);
const guias = allGuias.sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf());

const categories = ['streaming', 'viaje', 'idioma', 'cultura', 'general'];
---

<BaseLayout
  title="Guías de Cultura Coreana - Streaming, Viaje, Idioma"
  description="Guías completas sobre cultura coreana: cómo ver K-Dramas, aprender coreano, viajar a Corea y más. Todo explicado en español."
>
  <section class="bg-gradient-to-r from-teal-500 to-cyan-500 text-white">
    <div class="mx-auto max-w-7xl px-4 py-12 sm:px-6 lg:px-8">
      <h1 class="text-3xl font-bold sm:text-4xl">Guías</h1>
      <p class="mt-2 text-lg text-teal-100">
        Todo lo que necesitas saber sobre la cultura coreana
      </p>
    </div>
  </section>

  <section class="py-12">
    <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
      <!-- Category Filter -->
      <div class="mb-8 flex flex-wrap gap-2">
        <a
          href="/guias"
          class="rounded-full bg-teal-600 px-4 py-2 text-sm font-medium text-white"
        >
          Todas
        </a>
        {categories.map((cat) => (
          <a
            href={`/guias/categoria/${cat}`}
            class="rounded-full bg-gray-100 px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-200 transition-colors capitalize"
          >
            {cat}
          </a>
        ))}
      </div>

      {guias.length > 0 ? (
        <div class="grid gap-6 sm:grid-cols-2 lg:grid-cols-3">
          {guias.map((guia) => (
            <article class="group rounded-lg border border-gray-200 bg-white overflow-hidden shadow-sm hover:shadow-md transition-shadow">
              {guia.data.heroImage && (
                <img
                  src={guia.data.heroImage}
                  alt={guia.data.heroImageAlt || guia.data.title}
                  class="h-48 w-full object-cover"
                  loading="lazy"
                />
              )}
              <div class="p-5">
                <div class="flex items-center gap-2 mb-3">
                  <span class="inline-block rounded-full bg-teal-100 px-3 py-1 text-xs font-medium text-teal-800 capitalize">
                    {guia.data.category}
                  </span>
                  {guia.data.difficulty && (
                    <span class="inline-block rounded-full bg-gray-100 px-3 py-1 text-xs font-medium text-gray-700 capitalize">
                      {guia.data.difficulty}
                    </span>
                  )}
                </div>
                <h2 class="text-lg font-semibold text-gray-900 group-hover:text-teal-600 line-clamp-2">
                  <a href={`/guias/${guia.slug}`}>
                    {guia.data.title}
                  </a>
                </h2>
                <p class="mt-2 text-sm text-gray-600 line-clamp-2">
                  {guia.data.description}
                </p>
                {guia.data.readingTime && (
                  <p class="mt-3 text-xs text-gray-500">
                    Tiempo de lectura: {guia.data.readingTime} min
                  </p>
                )}
              </div>
            </article>
          ))}
        </div>
      ) : (
        <div class="text-center py-12">
          <p class="text-gray-600">Próximamente: guías sobre streaming, viajes a Corea, idioma coreano y más</p>
        </div>
      )}
    </div>
  </section>
</BaseLayout>
